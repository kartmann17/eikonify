import{c as Q,r as y,u as $,j as t,e as H,H as G}from"./app-CV50y06C.js";import{A as V}from"./app-layout-BNGGgNAT.js";import{H as J,S as K}from"./heading-small-DgGxpgTk.js";import{c as q,B as I}from"./button-CfSFJDFM.js";import{I as P}from"./input-CJ06F9vs.js";import{L as U}from"./label-DXHT2DX8.js";import{I as W}from"./input-error-DDkBg4rF.js";import{A as M,a as R}from"./alert-Dn5wUWAV.js";import{L as T}from"./loader-circle-CBAruBTF.js";import{S as X}from"./shield-6ts9j8sG.js";/* empty css            */import"./index-ZxZ2tTPo.js";import"./index-lR1wftDR.js";import"./index-C_LOcsl0.js";import"./index-3MVwMtDo.js";import"./x-CFMgtiK-.js";import"./index-Dip9cXWT.js";import"./index-DcdCdbjR.js";import"./index-CKyY3FCJ.js";import"./settings-DvOtzv6a.js";import"./credit-card-BbDXwDsd.js";const Y=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Z=q("ShieldCheck",Y);const ee=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]],te=q("ShieldOff",ee),se=[{title:"Settings",href:"/settings/profile"},{title:"Two-Factor Auth",href:"/settings/two-factor"}];function Ae(o){const e=Q.c(31),{twoFactorEnabled:s,requiresConfirmation:w}=o,[l,z]=y.useState(!1),[m,E]=y.useState(!1),[d,_]=y.useState(null);let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=[],e[0]=u):u=e[0];const[p,D]=y.useState(u);let h;e[1]===Symbol.for("react.memo_cache_sentinel")?(h={code:""},e[1]=h):h=e[1];const{data:N,setData:C,post:A,processing:f,errors:k,reset:F}=$(h);let x;e[2]===Symbol.for("react.memo_cache_sentinel")?(x=()=>{z(!0),H.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>{fetch("/user/two-factor-qr-code").then(ae).then(r=>_(r.svg)),fetch("/user/two-factor-recovery-codes").then(re).then(r=>D(r))},onFinish:()=>z(!1)})},e[2]=x):x=e[2];const B=x;let j;e[3]!==A||e[4]!==F?(j=r=>{r.preventDefault(),A("/user/confirmed-two-factor-authentication",{preserveScroll:!0,onSuccess:()=>{F(),_(null)}})},e[3]=A,e[4]=F,e[5]=j):j=e[5];const L=j;let v;e[6]===Symbol.for("react.memo_cache_sentinel")?(v=()=>{E(!0),H.delete("/user/two-factor-authentication",{preserveScroll:!0,onFinish:()=>{E(!1),_(null),D([])}})},e[6]=v):v=e[6];const O=v;let g;e[7]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx(G,{title:"Two-Factor Authentication"}),e[7]=g):g=e[7];let S;e[8]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx(J,{title:"Authentification à deux facteurs",description:"Ajoutez une couche de sécurité supplémentaire à votre compte"}),e[8]=S):S=e[8];let a;e[9]!==s?(a=s?t.jsxs(M,{className:"border-green-200 bg-green-50",children:[t.jsx(Z,{className:"h-4 w-4 text-green-600"}),t.jsx(R,{className:"text-green-800",children:"L'authentification à deux facteurs est activée."})]}):t.jsxs(M,{children:[t.jsx(te,{className:"h-4 w-4"}),t.jsx(R,{children:"L'authentification à deux facteurs n'est pas activée."})]}),e[9]=s,e[10]=a):a=e[10];let c;e[11]!==L||e[12]!==N||e[13]!==k||e[14]!==f||e[15]!==d||e[16]!==w||e[17]!==C||e[18]!==s?(c=d&&!s&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Scannez ce QR code avec votre application d'authentification (Google Authenticator, Authy, etc.)"}),t.jsx("div",{className:"inline-block bg-white p-4 rounded-lg",dangerouslySetInnerHTML:{__html:d}}),w&&t.jsxs("form",{onSubmit:L,className:"space-y-4",children:[t.jsxs("div",{className:"grid gap-2 max-w-xs",children:[t.jsx(U,{htmlFor:"code",children:"Code de confirmation"}),t.jsx(P,{id:"code",value:N.code,onChange:r=>C("code",r.target.value),placeholder:"000000",maxLength:6}),t.jsx(W,{message:k.code})]}),t.jsxs(I,{type:"submit",disabled:f,children:[f&&t.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirmer"]})]})]}),e[11]=L,e[12]=N,e[13]=k,e[14]=f,e[15]=d,e[16]=w,e[17]=C,e[18]=s,e[19]=c):c=e[19];let i;e[20]!==p?(i=p.length>0&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Conservez ces codes de récupération dans un endroit sûr. Ils vous permettront de récupérer l'accès à votre compte si vous perdez votre appareil."}),t.jsx("div",{className:"bg-muted p-4 rounded-lg font-mono text-sm",children:p.map(oe)})]}),e[20]=p,e[21]=i):i=e[21];let n;e[22]!==m||e[23]!==l||e[24]!==s?(n=t.jsx("div",{className:"flex gap-2",children:s?t.jsxs(I,{variant:"destructive",onClick:O,disabled:m,children:[m&&t.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Désactiver"]}):t.jsxs(I,{onClick:B,disabled:l,children:[l&&t.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),t.jsx(X,{className:"mr-2 h-4 w-4"}),"Activer"]})}),e[22]=m,e[23]=l,e[24]=s,e[25]=n):n=e[25];let b;return e[26]!==i||e[27]!==n||e[28]!==a||e[29]!==c?(b=t.jsxs(V,{breadcrumbs:se,children:[g,t.jsx(K,{children:t.jsxs("div",{className:"space-y-6",children:[S,a,c,i,n]})})]}),e[26]=i,e[27]=n,e[28]=a,e[29]=c,e[30]=b):b=e[30],b}function oe(o,e){return t.jsx("div",{children:o},e)}function re(o){return o.json()}function ae(o){return o.json()}export{Ae as default};
