import{r as R,j as s,c as A,e as T}from"./app-X3ZGJWL7.js";import{c as J,B as H,b as G}from"./button-D500PmsH.js";import{S as L,a as Z}from"./seo-head-DJBm-T8x.js";import{b as o,c,C as M,a as z,d as K}from"./card-CkgHl2dW.js";import{I as V}from"./image-card-Yw2zlaYD.js";import{D as Q}from"./download-DrrBBkkj.js";import{u as U}from"./use-conversion-DJrMg3yu.js";import{R as P}from"./refresh-cw-B2wxenAn.js";import{A as W}from"./arrow-left-AUgy9F9t.js";import{H as X}from"./house-C3CfF_6s.js";/* empty css            */import"./badge-BJcbcsK-.js";import"./index-Cd9KG4SW.js";import"./x-Dj1o6une.js";import"./loader-circle-Bt5ujckM.js";import"./check-Cmr9BaLA.js";const Y=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],ee=J("Code",Y);const se=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],te=J("FileJson",se);const re=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],le=J("FileSpreadsheet",re),ae=[{format:"zip",label:"Archive ZIP",description:"Images converties + fichiers de métadonnées",icon:s.jsx(Q,{className:"h-5 w-5"})},{format:"csv",label:"Fichier CSV",description:"Métadonnées SEO au format tableur",icon:s.jsx(le,{className:"h-5 w-5"})},{format:"json",label:"Fichier JSON",description:"Données structurées pour intégration CMS",icon:s.jsx(te,{className:"h-5 w-5"})},{format:"html",label:"Snippets HTML",description:"Balises <img> et <picture> prêtes à copier",icon:s.jsx(ee,{className:"h-5 w-5"})}];function ne({batch:t,className:e}){const[n,i]=R.useState(null),q=R.useCallback(async r=>{i(r);try{const l=`/api/optiseo/export/${t.id}/${r}`;if(r!=="json"){const d=document.createElement("a");d.href=l,d.download=`optiseo-${t.id}.${r==="html"?"html":r}`,document.body.appendChild(d),d.click(),document.body.removeChild(d)}else window.open(l,"_blank")}catch(l){console.error("Export error:",l)}finally{i(null)}},[t.id]),u=t.images?.filter(r=>r.status==="completed").length??0,p=t.images?.reduce((r,l)=>l.size_saved&&l.size_saved>0?r+l.size_saved:r,0)??0;return s.jsxs("div",{className:G("space-y-6",e),children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-4",children:[s.jsx(o,{children:s.jsxs(c,{className:"pt-4",children:[s.jsx("p",{className:"text-2xl font-bold",children:u}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Images converties"})]})}),s.jsx(o,{children:s.jsxs(c,{className:"pt-4",children:[s.jsx("p",{className:"text-2xl font-bold",children:p>0?ie(p):"—"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Espace économisé"})]})}),s.jsx(o,{children:s.jsxs(c,{className:"pt-4",children:[s.jsx("p",{className:"text-2xl font-bold",children:t.settings?.format?.toUpperCase()??"—"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Format de sortie"})]})}),s.jsx(o,{children:s.jsxs(c,{className:"pt-4",children:[s.jsxs("p",{className:"text-2xl font-bold",children:[t.settings?.quality??80,"%"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Qualité"})]})})]}),s.jsxs(o,{children:[s.jsxs(M,{children:[s.jsx(z,{children:"Télécharger vos images"}),s.jsx(K,{children:"Choisissez le format d'export adapté à vos besoins"})]}),s.jsx(c,{children:s.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:ae.map(r=>s.jsxs(H,{variant:"outline",className:"h-auto flex-col items-start gap-2 p-4 text-left",onClick:()=>q(r.format),disabled:n!==null,children:[s.jsxs("div",{className:"flex w-full items-center gap-3",children:[n===r.format?s.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-primary border-t-transparent"}):r.icon,s.jsx("span",{className:"font-medium",children:r.label})]}),s.jsx("span",{className:"text-xs text-muted-foreground",children:r.description})]},r.format))})})]}),t.keywords&&t.keywords.length>0&&s.jsxs(o,{children:[s.jsx(M,{children:s.jsx(z,{className:"text-base",children:"Mots-clés utilisés"})}),s.jsx(c,{children:s.jsx("div",{className:"flex flex-wrap gap-2",children:t.keywords.map((r,l)=>s.jsx("span",{className:"rounded-full bg-muted px-3 py-1 text-sm",children:r},l))})})]})]})}function ie(t){if(t===0)return"0 B";const e=1024,n=["B","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,i)).toFixed(1))+" "+n[i]}function Be(t){const e=A.c(48),{batchId:n,initialBatch:i}=t,{batch:q,pollProgress:u}=U();let p,r;e[0]!==n||e[1]!==i||e[2]!==u?(p=()=>{i||u(n)},r=[n,i,u],e[0]=n,e[1]=i,e[2]=u,e[3]=p,e[4]=r):(p=e[3],r=e[4]),R.useEffect(p,r);const l=q??i,d=he;let B;e[5]!==n?(B=()=>{T.visit(`/convert/${n}`)},e[5]=n,e[6]=B):B=e[6];const S=B;if(!l){let a;return e[7]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsx("div",{className:"flex min-h-screen items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(P,{className:"mx-auto h-8 w-8 animate-spin text-muted-foreground"}),s.jsx("p",{className:"mt-4 text-muted-foreground",children:"Chargement des résultats..."})]})}),e[7]=a):a=e[7],a}let f,m,j,x,g,N,h,v,y,b;if(e[8]!==l||e[9]!==S){const a=l.images?.filter(xe)??[],D=l.images?.filter(me)??[];e[20]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx(L,{...Z.result}),e[20]=x):x=e[20],j="min-h-screen bg-gradient-to-b from-background to-muted/30",f="container mx-auto px-4 py-8";let F;e[21]===Symbol.for("react.memo_cache_sentinel")?(F=s.jsx(W,{className:"mr-2 h-4 w-4"}),e[21]=F):F=e[21];let _;e[22]!==S?(_=s.jsxs(H,{variant:"ghost",onClick:S,children:[F,"Paramètres"]}),e[22]=S,e[23]=_):_=e[23];let O;e[24]===Symbol.for("react.memo_cache_sentinel")?(O=s.jsxs(H,{variant:"outline",onClick:d,children:[s.jsx(X,{className:"mr-2 h-4 w-4"}),"Nouvelle conversion"]}),e[24]=O):O=e[24],e[25]!==_?(m=s.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[_,O]}),e[25]=_,e[26]=m):m=e[26],g="mx-auto max-w-5xl space-y-8";let $;e[27]===Symbol.for("react.memo_cache_sentinel")?($=s.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"Conversion terminée !"}),e[27]=$):$=e[27],N=s.jsxs("div",{className:"text-center",children:[$,s.jsxs("p",{className:"text-muted-foreground",children:[a.length," image",a.length>1?"s":""," convertie",a.length>1?"s":""," avec succès"]})]}),e[28]!==l?(h=s.jsx(ne,{batch:l}),e[28]=l,e[29]=h):h=e[29],v=a.length>0&&s.jsxs(o,{children:[s.jsx(M,{children:s.jsx(z,{children:"Images converties"})}),s.jsx(c,{children:s.jsx("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4",children:a.map(de)})})]}),y=D.length>0&&s.jsxs(o,{className:"border-destructive/50",children:[s.jsx(M,{children:s.jsxs(z,{className:"text-destructive",children:["Images en échec (",D.length,")"]})}),s.jsx(c,{children:s.jsx("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4",children:D.map(ce)})})]}),b=a.length>0&&s.jsxs(o,{children:[s.jsx(M,{children:s.jsx(z,{children:"Métadonnées SEO générées"})}),s.jsx(c,{children:s.jsxs("div",{className:"space-y-4",children:[a.slice(0,5).map(oe),a.length>5&&s.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:["... et ",a.length-5," autres images. Téléchargez le fichier CSV ou JSON pour voir toutes les métadonnées."]})]})})]}),e[8]=l,e[9]=S,e[10]=f,e[11]=m,e[12]=j,e[13]=x,e[14]=g,e[15]=N,e[16]=h,e[17]=v,e[18]=y,e[19]=b}else f=e[10],m=e[11],j=e[12],x=e[13],g=e[14],N=e[15],h=e[16],v=e[17],y=e[18],b=e[19];let E;e[30]===Symbol.for("react.memo_cache_sentinel")?(E=s.jsx("div",{className:"text-center",children:s.jsxs(H,{size:"lg",onClick:d,className:"gap-2",children:[s.jsx(P,{className:"h-5 w-5"}),"Convertir d'autres images"]})}),e[30]=E):E=e[30];let C;e[31]!==g||e[32]!==N||e[33]!==h||e[34]!==v||e[35]!==y||e[36]!==b?(C=s.jsxs("div",{className:g,children:[N,h,v,y,b,E]}),e[31]=g,e[32]=N,e[33]=h,e[34]=v,e[35]=y,e[36]=b,e[37]=C):C=e[37];let k;e[38]!==f||e[39]!==m||e[40]!==C?(k=s.jsxs("div",{className:f,children:[m,C]}),e[38]=f,e[39]=m,e[40]=C,e[41]=k):k=e[41];let w;e[42]!==j||e[43]!==k?(w=s.jsx("div",{className:j,children:k}),e[42]=j,e[43]=k,e[44]=w):w=e[44];let I;return e[45]!==x||e[46]!==w?(I=s.jsxs(s.Fragment,{children:[x,w]}),e[45]=x,e[46]=w,e[47]=I):I=e[47],I}function oe(t){return s.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4",children:[s.jsx("p",{className:"mb-2 font-medium text-sm",children:t.seo.filename}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"alt:"})," ",s.jsxs("span",{className:"text-foreground",children:['"',t.seo.alt_text,'"']})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"title:"})," ",s.jsxs("span",{className:"text-foreground",children:['"',t.seo.title_text,'"']})]}),t.seo.meta_description&&s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"meta:"})," ",s.jsxs("span",{className:"text-foreground",children:['"',t.seo.meta_description,'"']})]})]})]},t.id)}function ce(t){return s.jsx(V,{image:t},t.id)}function de(t){return s.jsx(V,{image:t},t.id)}function me(t){return t.status==="failed"}function xe(t){return t.status==="completed"}function he(){T.visit("/")}export{Be as default};
