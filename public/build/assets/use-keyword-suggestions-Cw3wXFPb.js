import{c as H,b as $,B as N}from"./button-CxsBUnQw.js";import{c as G,j as s,r as m,L as W}from"./app-B4MOq35b.js";import{D as Z,a as Q,b as U,c as Y,d as ee,e as se,f as te}from"./dialog-CH6KOdUs.js";import{L as J}from"./label-DIX26Xzg.js";import{B as M}from"./badge-CMeIUBAB.js";import{L as ae}from"./lock-DQ0nZWhL.js";import{C as _}from"./crown-CJ99MXKi.js";import{S as B}from"./sparkles-6UyK-GHU.js";import{L as re}from"./loader-circle-Wi5_1wlF.js";import{I as ne}from"./input-BFjrS0qZ.js";import{X as le}from"./x-Bw9THrat.js";const ie=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Ne=H("ArrowRight",ie);const oe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],V=H("Plus",oe);const ce=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],de=H("WandSparkles",ce);function ue(x){const e=G.c(8);let t,n;e[0]!==x?({className:t,...n}=x,e[0]=x,e[1]=t,e[2]=n):(t=e[1],n=e[2]);let i;e[3]!==t?(i=$("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),e[3]=t,e[4]=i):i=e[4];let l;return e[5]!==n||e[6]!==i?(l=s.jsx("textarea",{"data-slot":"textarea",className:i,...n}),e[5]=n,e[6]=i,e[7]=l):l=e[7],l}function ke({onKeywordsGenerated:x,disabled:e,isPro:t=!1}){const[n,i]=m.useState(!1),[l,w]=m.useState(""),[y,b]=m.useState(!1),[h,c]=m.useState([]),[r,u]=m.useState([]),[d,k]=m.useState(null),S=async()=>{if(l.trim().length<10){k("Veuillez décrire votre activité en au moins 10 caractères.");return}b(!0),k(null),c([]),u([]);try{const a=await fetch("/api/optiseo/keywords/suggest-from-activity",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({activity:l.trim(),language:"fr"})});if(!a.ok){const v=await a.json();throw new Error(v.message||"Erreur lors de la génération")}const p=await a.json();c(p.suggestions||[]),u([])}catch(a){k(a instanceof Error?a.message:"Erreur inconnue")}finally{b(!1)}},g=a=>{u(p=>p.includes(a)?p.filter(v=>v!==a):[...p,a])},C=()=>{x(r),i(!1),w(""),c([]),u([])},j=a=>{switch(a){case"produit":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";case"service":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"adjectif":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300";case"lieu":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}};return s.jsxs(Z,{open:n,onOpenChange:i,children:[s.jsx(Q,{asChild:!0,children:s.jsxs(N,{variant:"outline",size:"sm",disabled:e,className:"gap-2",children:[t?s.jsx(de,{className:"h-4 w-4"}):s.jsx(ae,{className:"h-4 w-4"}),"Suggérer par IA",!t&&s.jsxs(M,{variant:"secondary",className:"ml-1 bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200",children:[s.jsx(_,{className:"mr-1 h-3 w-3"}),"Pro"]})]})}),s.jsxs(U,{className:"sm:max-w-[600px]",children:[s.jsxs(Y,{children:[s.jsxs(ee,{className:"flex items-center gap-2",children:[s.jsx(B,{className:"h-5 w-5 text-primary"}),"Génération de mots-clés par IA",s.jsxs(M,{variant:"secondary",className:"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200",children:[s.jsx(_,{className:"mr-1 h-3 w-3"}),"Pro"]})]}),s.jsx(se,{children:"Décrivez votre activité et l'IA vous suggérera des mots-clés SEO pertinents pour vos images."})]}),t?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"activity",children:"Décrivez votre activité"}),s.jsx(ue,{id:"activity",placeholder:"Ex: Je suis photographe de mariage spécialisé dans les cérémonies en plein air dans le sud de la France. Je propose également des séances photo de couple et des portraits...",value:l,onChange:a=>w(a.target.value),rows:4,className:"resize-none",disabled:y}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Plus votre description est détaillée, plus les suggestions seront pertinentes."})]}),d&&s.jsx("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-3",children:s.jsx("p",{className:"text-sm text-destructive",children:d})}),s.jsx(N,{onClick:S,disabled:y||l.trim().length<10,className:"w-full",children:y?s.jsxs(s.Fragment,{children:[s.jsx(re,{className:"mr-2 h-4 w-4 animate-spin"}),"Génération en cours..."]}):s.jsxs(s.Fragment,{children:[s.jsx(B,{className:"mr-2 h-4 w-4"}),"Générer les suggestions"]})}),h.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(J,{children:"Sélectionnez les mots-clés à utiliser"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.length," sélectionné",r.length>1?"s":""]})]}),s.jsx("div",{className:"flex flex-wrap gap-2 rounded-lg border p-3 max-h-48 overflow-y-auto",children:h.map((a,p)=>s.jsxs(M,{variant:"outline",className:`cursor-pointer transition-all ${r.includes(a.keyword)?"bg-green-500 text-white border-green-500 hover:bg-green-600":j(a.category||"general")}`,onClick:()=>g(a.keyword),children:[r.includes(a.keyword)&&s.jsx(V,{className:"mr-1 h-3 w-3 rotate-45"}),a.keyword]},p))})]})]}),s.jsxs(te,{children:[s.jsx(N,{variant:"outline",onClick:()=>i(!1),children:"Annuler"}),s.jsxs(N,{onClick:C,disabled:r.length===0,children:["Ajouter ",r.length," mot",r.length>1?"s":"","-clé",r.length>1?"s":""]})]})]}):s.jsxs("div",{className:"py-8 text-center space-y-4",children:[s.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center",children:s.jsx(_,{className:"h-8 w-8 text-amber-600 dark:text-amber-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Fonctionnalité Pro"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"La génération de mots-clés par IA est réservée aux abonnés Pro."})]}),s.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[s.jsx("p",{children:"Avec le plan Pro à 9,99€/mois :"}),s.jsxs("ul",{className:"list-disc list-inside text-left max-w-xs mx-auto",children:[s.jsx("li",{children:"500 images par mois"}),s.jsx("li",{children:"500 suppressions d'arrière-plan"}),s.jsx("li",{children:"Suggestions IA personnalisées"}),s.jsx("li",{children:"Historique des conversions"}),s.jsx("li",{children:"Export ZIP, CSV, JSON, HTML"})]})]}),s.jsx(W,{href:"/billing",children:s.jsxs(N,{className:"gap-2",children:[s.jsx(_,{className:"h-4 w-4"}),"Passer au plan Pro"]})})]})]})]})}function Se(x){const e=G.c(51),{keywords:t,onChange:n,suggestions:i,onFetchSuggestions:l,maxKeywords:w,disabled:y,className:b}=x;let h;e[0]!==i?(h=i===void 0?[]:i,e[0]=i,e[1]=h):h=e[1];const c=h,r=w===void 0?10:w,u=y===void 0?!1:y,[d,k]=m.useState("");let S;e[2]!==t||e[3]!==r||e[4]!==n?(S=o=>{const f=o.trim().toLowerCase();f&&!t.includes(f)&&t.length<r&&(n([...t,f]),k(""))},e[2]=t,e[3]=r,e[4]=n,e[5]=S):S=e[5];const g=S;let C;e[6]!==t||e[7]!==n?(C=o=>{n(t.filter((f,X)=>X!==o))},e[6]=t,e[7]=n,e[8]=C):C=e[8];const j=C;let a;e[9]!==g||e[10]!==d||e[11]!==t.length||e[12]!==j?(a=o=>{o.key==="Enter"?(o.preventDefault(),g(d)):o.key==="Backspace"&&!d&&t.length>0&&j(t.length-1)},e[9]=g,e[10]=d,e[11]=t.length,e[12]=j,e[13]=a):a=e[13];const p=a;let v;e[14]!==g?(v=o=>{g(o.keyword)},e[14]=g,e[15]=v):v=e[15];const R=v;let E;e[16]!==b?(E=$("space-y-4",b),e[16]=b,e[17]=E):E=e[17];let O;e[18]===Symbol.for("react.memo_cache_sentinel")?(O=o=>k(o.target.value),e[18]=O):O=e[18];const q=u||t.length>=r;let L;e[19]!==p||e[20]!==d||e[21]!==q?(L=s.jsx(ne,{type:"text",placeholder:"Entrez un mot-clé et appuyez sur Entrée...",value:d,onChange:O,onKeyDown:p,disabled:q,className:"pr-10"}),e[19]=p,e[20]=d,e[21]=q,e[22]=L):L=e[22];let A;e[23]!==g||e[24]!==d?(A=d&&s.jsx(N,{type:"button",variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2",onClick:()=>g(d),children:s.jsx(V,{className:"h-4 w-4"})}),e[23]=g,e[24]=d,e[25]=A):A=e[25];let D;e[26]!==L||e[27]!==A?(D=s.jsxs("div",{className:"relative flex-1",children:[L,A]}),e[26]=L,e[27]=A,e[28]=D):D=e[28];let K;e[29]!==u||e[30]!==l?(K=l&&s.jsxs(N,{type:"button",variant:"outline",onClick:l,disabled:u,children:[s.jsx(B,{className:"mr-2 h-4 w-4"}),"Suggestions"]}),e[29]=u,e[30]=l,e[31]=K):K=e[31];let I;e[32]!==D||e[33]!==K?(I=s.jsxs("div",{className:"flex gap-2",children:[D,K]}),e[32]=D,e[33]=K,e[34]=I):I=e[34];let z;e[35]!==u||e[36]!==t||e[37]!==j?(z=t.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:t.map((o,f)=>s.jsxs(M,{variant:"secondary",className:"gap-1 pr-1",children:[o,s.jsx("button",{type:"button",onClick:()=>j(f),className:"ml-1 rounded-full p-0.5 hover:bg-muted-foreground/20",disabled:u,children:s.jsx(le,{className:"h-3 w-3"})})]},f))}),e[35]=u,e[36]=t,e[37]=j,e[38]=z):z=e[38];let P;e[39]!==t.length||e[40]!==r?(P=s.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.length," / ",r," mots-clés"]}),e[39]=t.length,e[40]=r,e[41]=P):P=e[41];let F;e[42]!==R||e[43]!==c?(F=c.length>0&&s.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[s.jsx("p",{className:"mb-2 text-xs font-medium text-muted-foreground",children:"Suggestions"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:c.map((o,f)=>s.jsxs(M,{variant:"outline",className:"cursor-pointer hover:bg-primary hover:text-primary-foreground",onClick:()=>R(o),children:[o.keyword,s.jsxs("span",{className:"ml-1 text-xs opacity-60",children:[o.relevance,"%"]})]},f))})]}),e[42]=R,e[43]=c,e[44]=F):F=e[44];let T;return e[45]!==I||e[46]!==z||e[47]!==P||e[48]!==F||e[49]!==E?(T=s.jsxs("div",{className:E,children:[I,z,P,F]}),e[45]=I,e[46]=z,e[47]=P,e[48]=F,e[49]=E,e[50]=T):T=e[50],T}function Ce(){const[x,e]=m.useState([]),[t,n]=m.useState(!1),[i,l]=m.useState(null),w=m.useCallback(async(b,h)=>{n(!0),l(null);try{const c=await fetch("/api/optiseo/keywords/suggest",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({filename:b,keywords:h})});if(!c.ok)throw new Error("Erreur lors de la récupération des suggestions");const r=await c.json();e(r.suggestions)}catch(c){const r=c instanceof Error?c.message:"Erreur inconnue";l(r)}finally{n(!1)}},[]),y=m.useCallback(()=>{e([]),l(null)},[]);return{suggestions:x,isLoading:t,error:i,fetchSuggestions:w,clearSuggestions:y}}export{ke as A,Se as K,Ne as a,Ce as u};
