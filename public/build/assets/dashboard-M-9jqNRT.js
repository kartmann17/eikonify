import{c as ee,r as G,j as e,L as k,e as M,H as se}from"./app-B4MOq35b.js";import{A as te}from"./app-layout-B_4UpSXM.js";import{c as q,b as z,a as R,C as T,d as E}from"./card-DZM7bfB2.js";import{c as ae,B as n}from"./button-CxsBUnQw.js";import{P as O}from"./progress-D60LEYvO.js";import{B as V}from"./badge-CMeIUBAB.js";import{A as Q,a as $}from"./alert-CA17EkvH.js";import{D as re,a as ne,b as le,c as ie,d as ce,e as oe,f as de}from"./dialog-CH6KOdUs.js";import{I as X}from"./image-Dznv0gXY.js";import{S as me}from"./scissors-BA9idCnc.js";import{T as J}from"./triangle-alert-D697BwTz.js";import{S as xe}from"./settings-B5HxOiXY.js";import{R as ue}from"./refresh-cw-Ck7-k6zc.js";import{X as pe}from"./x-Bw9THrat.js";import{A as he}from"./arrow-left-tNC5SaG3.js";import{T as fe}from"./trending-up-DoaSHcuN.js";import{C as je}from"./credit-card-B6UmYU8p.js";import{F as ge}from"./file-text-2wga7joC.js";import{D as _e}from"./download-DXC9WLu2.js";import{E as Ne}from"./external-link-BpFM-har.js";/* empty css            */import"./index-5f6hGpll.js";import"./index-COSMZq_y.js";import"./index-DDMaQtNZ.js";import"./index-B2ZfnCfK.js";import"./index-LCcYOGVk.js";import"./index-DlA2tQao.js";import"./index-DT914bK4.js";import"./index-CJPmBPF-.js";import"./index-Cnf8hYrl.js";import"./index-uL1tsYEd.js";import"./index-mbkb6Dy8.js";import"./shield-Dt9Ckr6Q.js";const be=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],K=ae("Package",be),ve=[{title:"Dashboard",href:"/dashboard"}];function ls(r){const s=ee.c(57),{quota:t,subscription:a,history:j,invoices:g}=r,[I,L]=G.useState(!1),[h,_]=G.useState(!1);let N;s[0]===Symbol.for("react.memo_cache_sentinel")?(N=()=>{_(!0),M.post("/subscription/cancel",{},{onFinish:()=>{_(!1),L(!1)}})},s[0]=N):N=s[0];const W=N;let b;s[1]===Symbol.for("react.memo_cache_sentinel")?(b=()=>{_(!0),M.post("/subscription/resume",{},{onFinish:()=>_(!1)})},s[1]=b):b=s[1];const Y=b,f=Ae,Z=Ce;let v;s[2]===Symbol.for("react.memo_cache_sentinel")?(v=e.jsx(se,{title:"Dashboard"}),s[2]=v):v=s[2];let y;s[3]===Symbol.for("react.memo_cache_sentinel")?(y=e.jsx("h1",{className:"text-2xl font-bold",children:"Mon espace"}),s[3]=y):y=s[3];let w;s[4]===Symbol.for("react.memo_cache_sentinel")?(w=e.jsxs("div",{className:"flex items-center justify-between",children:[y,e.jsx(k,{href:"/",children:e.jsxs(n,{variant:"outline",children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Retour a l'accueil"]})})]}),s[4]=w):w=s[4];let C;s[5]===Symbol.for("react.memo_cache_sentinel")?(C=e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-5 w-5"}),"Quotas mensuels"]}),s[5]=C):C=s[5];const H=t.plan==="pro"?"Votre consommation ce mois-ci":"Passez au plan Pro pour plus de fonctionnalites";let l;s[6]!==H?(l=e.jsxs(T,{children:[C,e.jsx(E,{children:H})]}),s[6]=H,s[7]=l):l=s[7];let i;s[8]!==t.bg_percentage||s[9]!==t.bg_quota||s[10]!==t.bg_used||s[11]!==t.days_remaining||s[12]!==t.is_exceeded||s[13]!==t.is_warning||s[14]!==t.percentage||s[15]!==t.plan||s[16]!==t.quota||s[17]!==t.reset_date||s[18]!==t.surplus||s[19]!==t.surplus_cost||s[20]!==t.used?(i=e.jsx(q,{className:"space-y-6",children:t.plan==="pro"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(X,{className:"h-4 w-4"}),"Conversions d'images"]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:[f(t.used)," / ",f(t.quota)]}),e.jsxs("span",{className:"font-medium",children:[t.percentage,"%"]})]}),e.jsx(O,{value:t.percentage,className:t.is_exceeded?"bg-red-100":t.is_warning?"bg-yellow-100":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(me,{className:"h-4 w-4"}),"Suppressions d'arriere-plan"]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:[f(t.bg_used)," / ",f(t.bg_quota)]}),e.jsxs("span",{className:"font-medium",children:[t.bg_percentage,"%"]})]}),e.jsx(O,{value:t.bg_percentage})]}),t.is_exceeded&&e.jsxs(Q,{variant:"destructive",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsxs($,{children:["Quota depasse ! Surplus de ",f(t.surplus)," images (",Z(t.surplus_cost),")"]})]}),t.is_warning&&!t.is_exceeded&&e.jsxs(Q,{children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx($,{children:"Vous avez utilise plus de 80% de votre quota mensuel."})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground border-t pt-4",children:[e.jsx("span",{children:"Prochain renouvellement"}),e.jsxs("span",{children:[t.reset_date," (",t.days_remaining," jours)"]})]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Avec le plan gratuit : 5 images/jour et 3 suppressions d'arriere-plan/jour."}),e.jsx(k,{href:"/billing",children:e.jsxs(n,{children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Passer au Pro"]})})]})}),s[8]=t.bg_percentage,s[9]=t.bg_quota,s[10]=t.bg_used,s[11]=t.days_remaining,s[12]=t.is_exceeded,s[13]=t.is_warning,s[14]=t.percentage,s[15]=t.plan,s[16]=t.quota,s[17]=t.reset_date,s[18]=t.surplus,s[19]=t.surplus_cost,s[20]=t.used,s[21]=i):i=s[21];let c;s[22]!==l||s[23]!==i?(c=e.jsxs(z,{children:[l,i]}),s[22]=l,s[23]=i,s[24]=c):c=s[24];let A;s[25]===Symbol.for("react.memo_cache_sentinel")?(A=e.jsxs(T,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Abonnement"]}),e.jsx(E,{children:"Gérez votre abonnement et vos moyens de paiement"})]}),s[25]=A):A=s[25];let S;s[26]===Symbol.for("react.memo_cache_sentinel")?(S=e.jsx("span",{className:"text-sm text-muted-foreground",children:"Plan actuel"}),s[26]=S):S=s[26];const B=a.plan==="pro"?"default":"secondary",U=a.plan==="pro"?"Pro":"Gratuit";let o;s[27]!==B||s[28]!==U?(o=e.jsxs("div",{className:"flex items-center justify-between",children:[S,e.jsx(V,{variant:B,children:U})]}),s[27]=B,s[28]=U,s[29]=o):o=s[29];let d;s[30]!==I||s[31]!==h||s[32]!==a.ends_at||s[33]!==a.is_on_grace_period||s[34]!==a.payment_method||s[35]!==a.plan||s[36]!==a.renews_at||s[37]!==a.started_at||s[38]!==a.status?(d=a.plan==="pro"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Statut"}),e.jsxs(V,{variant:a.status==="active"?"default":a.status==="canceling"?"outline":"destructive",children:[a.status==="active"&&"Actif",a.status==="canceling"&&"Annulation en cours",a.status==="canceled"&&"Annulé",a.status==="past_due"&&"Paiement en retard"]})]}),a.started_at&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Abonné depuis"}),e.jsx("span",{children:a.started_at})]}),a.renews_at&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Prochain renouvellement"}),e.jsx("span",{children:a.renews_at})]}),a.ends_at&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Fin d'abonnement"}),e.jsx("span",{children:a.ends_at})]}),a.payment_method&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Carte"}),e.jsxs("span",{className:"font-mono",children:[a.payment_method.brand.toUpperCase()," •••• ",a.payment_method.last4]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(k,{href:"/billing/portal",className:"flex-1",children:e.jsxs(n,{variant:"outline",className:"w-full",size:"sm",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Gérer"]})}),a.is_on_grace_period?e.jsxs(n,{onClick:Y,disabled:h,size:"sm",className:"flex-1",children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Reprendre"]}):a.status==="active"?e.jsxs(re,{open:I,onOpenChange:L,children:[e.jsx(ne,{asChild:!0,children:e.jsxs(n,{variant:"destructive",size:"sm",className:"flex-1",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Annuler"]})}),e.jsxs(le,{children:[e.jsxs(ie,{children:[e.jsx(ce,{children:"Annuler l'abonnement"}),e.jsx(oe,{children:"Êtes-vous sûr de vouloir annuler votre abonnement Pro ? Vous conserverez l'accès jusqu'à la fin de la période de facturation."})]}),e.jsxs(de,{children:[e.jsx(n,{variant:"outline",onClick:()=>L(!1),children:"Conserver"}),e.jsx(n,{variant:"destructive",onClick:W,disabled:h,children:h?"Annulation...":"Confirmer l'annulation"})]})]})]}):null]})]}),s[30]=I,s[31]=h,s[32]=a.ends_at,s[33]=a.is_on_grace_period,s[34]=a.payment_method,s[35]=a.plan,s[36]=a.renews_at,s[37]=a.started_at,s[38]=a.status,s[39]=d):d=s[39];let m;s[40]!==a.plan?(m=a.plan==="free"&&e.jsx(k,{href:"/billing",children:e.jsxs(n,{className:"w-full",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Passer au Pro (9,99 €/mois)"]})}),s[40]=a.plan,s[41]=m):m=s[41];let x;s[42]!==o||s[43]!==d||s[44]!==m?(x=e.jsxs(z,{children:[A,e.jsxs(q,{className:"space-y-4",children:[o,d,m]})]}),s[42]=o,s[43]=d,s[44]=m,s[45]=x):x=s[45];let D;s[46]===Symbol.for("react.memo_cache_sentinel")?(D=e.jsxs(T,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5"}),"Historique des conversions"]}),e.jsx(E,{children:"Vos 20 dernières conversions"})]}),s[46]=D):D=s[46];let u;s[47]!==j?(u=e.jsxs(z,{children:[D,e.jsx(q,{children:j.length===0?e.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"Aucune conversion pour le moment."}):e.jsx("div",{className:"space-y-2",children:j.map(we)})})]}),s[47]=j,s[48]=u):u=s[48];let P;s[49]===Symbol.for("react.memo_cache_sentinel")?(P=e.jsxs(T,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5"}),"Factures"]}),e.jsx(E,{children:"Vos factures et reçus de paiement"})]}),s[49]=P):P=s[49];let p;s[50]!==g?(p=e.jsxs(z,{children:[P,e.jsx(q,{children:g.length===0?e.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"Aucune facture disponible."}):e.jsx("div",{className:"space-y-2",children:g.map(ye)})})]}),s[50]=g,s[51]=p):p=s[51];let F;return s[52]!==c||s[53]!==x||s[54]!==u||s[55]!==p?(F=e.jsxs(te,{breadcrumbs:ve,children:[v,e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[w,e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[c,x,u,p]})]})]}),s[52]=c,s[53]=x,s[54]=u,s[55]=p,s[56]=F):F=s[56],F}function ye(r){return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:r.total}),e.jsx("span",{className:"text-xs text-muted-foreground",children:r.date})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:r.status==="paid"?"default":"secondary",children:r.status==="paid"?"Payée":"En attente"}),e.jsx("a",{href:r.download_url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(n,{size:"sm",variant:"ghost",children:e.jsx(Ne,{className:"h-4 w-4"})})})]})]},r.id)}function we(r){return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-sm font-medium",children:[r.images_count," image",r.images_count>1?"s":""," • ",r.output_format.toUpperCase()]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:r.date})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:"outline",className:"text-xs",children:r.status}),r.can_download&&e.jsx("a",{href:`/api/optiseo/export/${r.id}/zip`,children:e.jsx(n,{size:"sm",variant:"ghost",children:e.jsx(_e,{className:"h-4 w-4"})})})]})]},r.id)}function Ce(r){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(r)}function Ae(r){return new Intl.NumberFormat("fr-FR").format(r)}export{ls as default};
